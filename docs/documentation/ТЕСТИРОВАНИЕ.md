# ๐งช ะขะตััะพะฒัะต ะดะฐะฝะฝัะต ะดะปั ะฟัะพะฒะตัะบะธ MLM ัะธััะตะผั

## ะะฟะธัะฐะฝะธะต

ะญัะพั ัะฐะนะป ัะพะดะตัะถะธั ะฝะฐะฑะพั ัะตััะพะฒัั ััะตะฝะฐัะธะตะฒ ะดะปั ะฟัะพะฒะตัะบะธ ะบะพััะตะบัะฝะพััะธ ัะฐะฑะพัั ัะบัะธะฟัะฐ.

---

## ๐ ะขะตััะพะฒัะต ััะตะฝะฐัะธะธ

### ะกัะตะฝะฐัะธะน 1: ะะพะฒัะน ะบะปะธะตะฝั, L1=ะะฐััะฝะตั, L2=ะฝะตั

**ะะฐะฝะฝัะต ะดะปั payments:**
```
transaction_id: TEST_001
transaction_time: 12.12.2025
referal_id: 227783140
referal_name: ะฏะฝ ะะพัะพะฝะบะพะฒ
client_level: 1
product_id: 1
payment: 1000
```

**ะะถะธะดะฐะตะผัะน ัะตะทัะปััะฐั:**
- L1 (ะฏะฝ ะะพัะพะฝะบะพะฒ, ID=227193871, level=2): 100โฝ (10%) + 1 ะฑะฐะปะป
- L2: 0โฝ (ั.ะบ. ะะฐัะธะฝะฐ level=2, ะฝัะถะตะฝ 3+)

---

### ะกัะตะฝะฐัะธะน 2: ะะพะฒัะพัะฝัะน ะบะปะธะตะฝั, L1=ะะฐััะฝะตั

**ะะฐะฝะฝัะต ะดะปั payments:**
```
transaction_id: TEST_002
transaction_time: 12.12.2025
referal_id: 227783140
referal_name: ะฏะฝ ะะพัะพะฝะบะพะฒ
client_level: 2
product_id: 2
payment: 2000
```

**ะะถะธะดะฐะตะผัะน ัะตะทัะปััะฐั:**
- L1 (ะฏะฝ ะะพัะพะฝะบะพะฒ): 100โฝ (5%) + 3 ะฑะฐะปะปะฐ
- L2: 0โฝ (ะฟะพะฒัะพัะฝัะน ะบะปะธะตะฝั)

---

### ะกัะตะฝะฐัะธะน 3: ะะพะฒัะน ะบะปะธะตะฝั, L1=ะะะ, L2=ะะะ

**ะะพะดะณะพัะพะฒะบะฐ:** ะะทะผะตะฝะธัะต ะฒ referals:
- 227193871 (ะฏะฝ ะะพัะพะฝะบะพะฒ) โ referal_level = 3
- 227290741 (ะะฐัะธะฝะฐ ะขะฐะปัะบะพ) โ referal_level = 3

**ะะฐะฝะฝัะต ะดะปั payments:**
```
transaction_id: TEST_003
transaction_time: 12.12.2025
referal_id: 227783140
referal_name: ะฏะฝ ะะพัะพะฝะบะพะฒ
client_level: 1
product_id: 2
payment: 3000
```

**ะะถะธะดะฐะตะผัะน ัะตะทัะปััะฐั:**
- L1 (ะฏะฝ, level=3): 450โฝ (15%) + 3 ะฑะฐะปะปะฐ
- L2 (ะะฐัะธะฝะฐ, level=3): 150โฝ (5%)

---

### ะกัะตะฝะฐัะธะน 4: ะะปะธะตะฝั ะฑะตะท ะฝะฐััะฐะฒะฝะธะบะฐ

**ะะพะดะณะพัะพะฒะบะฐ:** ะะพะฑะฐะฒััะต ะฒ referals:
```
referal_id: TEST_USER
referalName: ะขะตััะพะฒัะน ะะพะปัะทะพะฒะฐัะตะปั
referal_level: 1
client_level: 1
referer_id: [ะะฃะกะขะ]
```

**ะะฐะฝะฝัะต ะดะปั payments:**
```
transaction_id: TEST_004
transaction_time: 12.12.2025
referal_id: TEST_USER
referal_name: ะขะตััะพะฒัะน ะะพะปัะทะพะฒะฐัะตะปั
client_level: 1
product_id: 1
payment: 500
```

**ะะถะธะดะฐะตะผัะน ัะตะทัะปััะฐั:**
- L1: ะฟัััะพ (ะฝะตั ะฝะฐััะฐะฒะฝะธะบะฐ)
- L2: ะฟัััะพ
- ะ ะปะพะณะฐั: "ะฃ ะฟะพะบัะฟะฐัะตะปั ะฝะตั ะฝะฐััะฐะฒะฝะธะบะฐ"

---

### ะกัะตะฝะฐัะธะน 5: ะะตัััะตััะฒัััะธะน ะฟะพะบัะฟะฐัะตะปั

**ะะฐะฝะฝัะต ะดะปั payments:**
```
transaction_id: TEST_005
transaction_time: 12.12.2025
referal_id: 999999999
referal_name: ะะตัััะตััะฒัััะธะน
client_level: 1
product_id: 1
payment: 100
```

**ะะถะธะดะฐะตะผัะน ัะตะทัะปััะฐั:**
- ะกััะพะบะฐ ะฟัะพะฟััะบะฐะตััั
- ะ ะปะพะณะฐั: "ะะพะบัะฟะฐัะตะปั ID=999999999 ะฝะต ะฝะฐะนะดะตะฝ ะฒ ะฑะฐะทะต referals"
- ะ ััะฐัะธััะธะบะต: +1 ะบ ะพัะธะฑะบะฐะผ

---

## โ ะงะตะบ-ะปะธัั ะฟัะพะฒะตัะบะธ

ะะพัะปะต ัััะฐะฝะพะฒะบะธ ัะบัะธะฟัะฐ ะฟัะพะฒะตัััะต:

- [ ] ะะตะฝั "๐ฐ MLM ะะพะฝััั" ะฟะพัะฒะธะปะพัั ะฒ ัะฐะฑะปะธัะต
- [ ] ะคัะฝะบัะธั "๐ ะะฐัััะธัะฐัั ะฑะพะฝััั" ะทะฐะฟััะบะฐะตััั ะฑะตะท ะพัะธะฑะพะบ
- [ ] ะคัะฝะบัะธั "๐๏ธ ะัะธััะธัั ะฒัะต ะฑะพะฝััั" ัะฐะฑะพัะฐะตั ั ะฟะพะดัะฒะตัะถะดะตะฝะธะตะผ
- [ ] ะะฑัะฐะฑะพัะฐะฝะฝัะต ัััะพะบะธ ะะ ะพะฑัะฐะฑะฐััะฒะฐัััั ะฟะพะฒัะพัะฝะพ
- [ ] ะะปั ะฝะพะฒัั ะบะปะธะตะฝัะพะฒ L1 ะฟะพะปััะฐะตั 10-15%
- [ ] ะะปั ะฟะพะฒัะพัะฝัั ะบะปะธะตะฝัะพะฒ L1 ะฟะพะปััะฐะตั 5%
- [ ] L2 ะฟะพะปััะฐะตั ะฑะพะฝัั ัะพะปัะบะพ ะดะปั ะฝะพะฒัั ะบะปะธะตะฝัะพะฒ ะฟัะธ level=3+
- [ ] ะะฐะปะปั ะฝะฐัะธัะปััััั ะฟัะฐะฒะธะปัะฝะพ (1 ะธะปะธ 3)
- [ ] ะัะพัะตะฝัั ะทะฐะฟะธััะฒะฐัััั ะฒ ะบะพะปะพะฝะบะธ P ะธ Q
- [ ] ะัะธ ะพัะธะฑะบะฐั ะฟะพะบะฐะทัะฒะฐะตััั ะฟะพะฝััะฝะพะต ัะฒะตะดะพะผะปะตะฝะธะต
- [ ] ะะพะณะธ ะฟะพะดัะพะฑะฝัะต ะธ ะธะฝัะพัะผะฐัะธะฒะฝัะต

---

## ๐ ะัะธะผะตั ะทะฐะฟะพะปะฝะตะฝะธั referals ะดะปั ัะตััะพะฒ

```csv
referal_id,referalName,referal_nickname,referal_level,client_level,referer_id
100001,ะะดะผะธะฝ,admin,3,0,
100002,ะะฐััะฝะตั ะะตัะฒัะน,partner1,2,1,100001
100003,ะะฐััะฝะตั ะัะพัะพะน,partner2,2,1,100001
100004,ะะะ ะะฐััะฝะตั,vip1,3,1,100001
100005,ะะพะฒะธัะพะบ ะะตัะฒัะน,newbie1,1,1,100002
100006,ะะพะฒะธัะพะบ ะัะพัะพะน,newbie2,1,1,100004
```

**ะกัััะบัััะฐ:**
- ะะดะผะธะฝ (100001) - ะณะปะฐะฒะฝัะน, level=3
- ะฃ ะฝะตะณะพ 3 ะฟััะผัั ัะตัะตัะฐะปะฐ: 100002, 100003, 100004
- ะฃ ะฟะฐััะฝะตัะพะฒ ะตััั ัะฒะพะธ ัะตัะตัะฐะปั

---

## ๐งช ะกะบัะธะฟั ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ัะตััะธัะพะฒะฐะฝะธั

```javascript
function runTests() {
  Logger.clear();
  Logger.log("โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ");
  Logger.log("๐งช ะะะะฃะกะ ะะะขะะะะขะะงะะกะะะฅ ะขะะกะขะะ");
  Logger.log("โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ");
  
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheetRef = ss.getSheetByName("referals");
  var sheetPay = ss.getSheetByName("payments");
  
  // ะขะตัั 1: ะัะพะฒะตัะบะฐ ัััะตััะฒะพะฒะฐะฝะธั ะปะธััะพะฒ
  if (sheetRef && sheetPay) {
    Logger.log("โ ะขะตัั 1: ะะธััั ัััะตััะฒััั");
  } else {
    Logger.log("โ ะขะตัั 1: ะะธััั ะะ ะฝะฐะนะดะตะฝั");
    return;
  }
  
  // ะขะตัั 2: ะัะพะฒะตัะบะฐ ััััะบัััั referals
  var refHeaders = sheetRef.getRange(1, 1, 1, 6).getValues()[0];
  var expectedRef = ["referal_id", "referalName", "referal_nickname", 
                     "referal_level", "client_level", "referer_id"];
  
  var refMatch = true;
  for (var i = 0; i < expectedRef.length; i++) {
    if (refHeaders[i] !== expectedRef[i]) {
      refMatch = false;
      Logger.log("โ ะขะตัั 2: ะะฐะณะพะปะพะฒะพะบ referals[" + i + "] ะฝะตัะพะฒะฟะฐะดะฐะตั: " + 
                 refHeaders[i] + " != " + expectedRef[i]);
    }
  }
  
  if (refMatch) {
    Logger.log("โ ะขะตัั 2: ะกัััะบัััะฐ referals ะบะพััะตะบัะฝะฐ");
  }
  
  // ะขะตัั 3: ะัะพะฒะตัะบะฐ ััััะบัััั payments
  var payHeaders = sheetPay.getRange(1, 1, 1, 18).getValues()[0];
  var expectedPay = ["transaction_id", "transaction_time", "referal_id", 
                     "referal_name", "client_level", "product_id", "payment",
                     "referer_L1", "referer_L1_name", "referer_L1_level",
                     "referer_L1_bonus", "referer_L1_bonus_points",
                     "referer_L2", "referer_L2_name", "referer_l2_level",
                     "referer_L2_bonus", "referer_L1_percent", "referer_L2_percent"];
  
  var payMatch = true;
  for (var i = 0; i < expectedPay.length; i++) {
    if (payHeaders[i] !== expectedPay[i]) {
      payMatch = false;
      Logger.log("โ ะขะตัั 3: ะะฐะณะพะปะพะฒะพะบ payments[" + i + "] ะฝะตัะพะฒะฟะฐะดะฐะตั: " + 
                 payHeaders[i] + " != " + expectedPay[i]);
    }
  }
  
  if (payMatch) {
    Logger.log("โ ะขะตัั 3: ะกัััะบัััะฐ payments ะบะพััะตะบัะฝะฐ (18 ะบะพะปะพะฝะพะบ)");
  }
  
  // ะขะตัั 4: ะัะพะฒะตัะบะฐ ะฝะฐะปะธัะธั ะดะฐะฝะฝัั
  var refCount = sheetRef.getLastRow() - 1;
  var payCount = sheetPay.getLastRow() - 1;
  
  Logger.log("โน๏ธ ะขะตัั 4: ะฃัะฐััะฝะธะบะพะฒ ะฒ ะฑะฐะทะต: " + refCount);
  Logger.log("โน๏ธ ะขะตัั 4: ะะปะฐัะตะถะตะน ะฒ ะฑะฐะทะต: " + payCount);
  
  if (refCount > 0) {
    Logger.log("โ ะขะตัั 4: ะะฐะฝะฝัะต ะฒ referals ะฟัะธัััััะฒััั");
  } else {
    Logger.log("โ๏ธ ะขะตัั 4: ะขะฐะฑะปะธัะฐ referals ะฟัััะฐ");
  }
  
  Logger.log("โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ");
  Logger.log("๐ ะขะะกะขะะะะะะะะ ะะะะะะจะะะ");
  Logger.log("โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ");
}
```

**ะะฐะบ ะทะฐะฟัััะธัั:**
1. ะะพะฑะฐะฒััะต ััะพั ะบะพะด ะฒ Apps Script
2. ะะฐะฟัััะธัะต ััะฝะบัะธั `runTests`
3. ะัะพะฒะตัััะต ะััะฝะฐะป ะฒัะฟะพะปะฝะตะฝะธั

---

## ๐ ะััะตั ะพ ัะตััะธัะพะฒะฐะฝะธะธ

ะะพัะปะต ะฒัะฟะพะปะฝะตะฝะธั ัะตััะพะฒ ะทะฐะฟะพะปะฝะธัะต:

| ะขะตัั | ะะตะทัะปััะฐั | ะัะธะผะตัะฐะฝะธั |
|------|-----------|------------|
| ะฃััะฐะฝะพะฒะบะฐ ัะบัะธะฟัะฐ | โฌ โ โ | |
| ะกะพะทะดะฐะฝะธะต ะผะตะฝั | โฌ โ โ | |
| ะกัะตะฝะฐัะธะน 1 | โฌ โ โ | |
| ะกัะตะฝะฐัะธะน 2 | โฌ โ โ | |
| ะกัะตะฝะฐัะธะน 3 | โฌ โ โ | |
| ะกัะตะฝะฐัะธะน 4 | โฌ โ โ | |
| ะกัะตะฝะฐัะธะน 5 | โฌ โ โ | |
| ะัะธััะบะฐ ะฑะพะฝััะพะฒ | โฌ โ โ | |
| ะะตัะตััะตั | โฌ โ โ | |

---

**ะะฐัะฐ ัะตััะธัะพะฒะฐะฝะธั:** ___________  
**ะัะพัะตััะธัะพะฒะฐะป:** ___________  
**ะะตััะธั ัะบัะธะฟัะฐ:** 2.0
